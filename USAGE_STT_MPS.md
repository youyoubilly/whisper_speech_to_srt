# STT_MPS.py - Usage Guide

## Quick Start

The script is now configured with optimal defaults for your setup!

### Basic Usage (Simplest)

```bash
python3 stt_mps.py -t -o /path/to/audio.m4a
```

This will:
- Use your local `large-v3` model in `/Users/billywang/Downloads/hf`
- Transcribe as **Cantonese** (`yue`)
- Run on **CPU** with optimal `float32` compute type
- Generate **SRT**, **TXT**, and **LRC** files in `./output/` directory

### Common Examples

**Single file with text output:**
```bash
python3 stt_mps.py -t -o /path/to/audio.m4a
```

**Batch process a directory:**
```bash
python3 stt_mps.py -t -o /path/to/audio/folder/
```

**Batch process recursively:**
```bash
python3 stt_mps.py -t -o -r /path/to/audio/folder/
```

**Force offline mode (no internet):**
```bash
python3 stt_mps.py -t -o --offline /path/to/audio.m4a
```

**Different language (Mandarin):**
```bash
python3 stt_mps.py -t -o --language zh /path/to/audio.m4a
```

**Auto-detect language:**
```bash
python3 stt_mps.py -t -o --language auto /path/to/audio.m4a
```

**Disable LRC generation:**
```bash
python3 stt_mps.py -t -o --no-lrc /path/to/audio.m4a
```

**Only generate SRT (no TXT, no LRC):**
```bash
python3 stt_mps.py -o --no-lrc /path/to/audio.m4a
```

## Current Defaults

- **Model**: `/Users/billywang/Downloads/hf` (large-v3)
- **Device**: `cpu` (faster-whisper doesn't support MPS)
- **Compute Type**: `auto` (automatically selects `float32` for CPU)
- **Language**: `yue` (Cantonese)
- **Output**: `./output/` directory
- **VAD**: Enabled (Voice Activity Detection)
- **Beam Size**: 5

## Performance

- **24-minute audio** â†’ ~29 minutes processing time
- **Ratio**: ~1.2x real-time (on CPU with large-v3 model)
- **Accuracy**: High quality for Cantonese

## Model Files Location

Your model files are in: `/Users/billywang/Downloads/hf/`

Required files:
- `model.bin` (3GB)
- `tokenizer.json`
- `vocabulary.json`
- `config.json`
- `preprocessor_config.json`

## Tips

1. **First run**: Already completed - model is downloaded and configured
2. **Offline mode**: Use `--offline` flag if network is unstable
3. **Batch processing**: Put all audio files in one folder and use `-r` flag
4. **Different models**: Can use `--model medium` or `--model base` for faster (less accurate) transcription
5. **Speaker diarization**: Use `--diarize` with HF_TOKEN environment variable set

## Supported Audio Formats

- `.m4a`
- `.mp3`
- `.wav`
- `.flac`
- `.aac`
- `.ogg`
- `.mp4` (extracts audio)

## Output Files

- **SRT**: Subtitle file with timestamps (for video editors) - **Always generated**
- **TXT**: Plain text transcript (with `-t` flag) - Optional
- **LRC**: Lyrics file with timestamps (for music players) - **Generated by default** (disable with `--no-lrc`)

